import{a as z}from"./chunk-55YTS6XV.js";import{Ab as I,Fa as i,Fb as E,Ga as n,H as y,Ha as l,Ia as x,K as w,Ka as _,Kb as D,L as v,La as m,Lb as $,Mb as U,Pb as V,Q as p,R as g,Ub as R,Xa as c,Ya as P,Za as u,fa as M,ga as h,ha as r,ma as O,ra as f,tb as k,ub as S,va as d,vb as T}from"./chunk-MIUFO4FE.js";import"./chunk-DGAILPFQ.js";var C=class o{constructor(t){this.http=t}apiUrl=R.API_URL;getPost(t,e){return this.http.get(`${this.apiUrl}/api/public/users/${t}/posts/${e}`)}getUserPosts(t,e=1,a=20){return this.http.get(`${this.apiUrl}/api/public/users/${t}/posts?page=${e}&per_page=${a}`)}getTimeline(t=1,e=20){return this.http.get(`${this.apiUrl}/api/posts?page=${t}&per_page=${e}`)}createPost(t){return this.http.post(`${this.apiUrl}/api/posts`,t)}toggleLike(t){return this.http.post(`${this.apiUrl}/api/posts/${t}/like`,{})}toggleRepost(t,e){return this.http.post(`${this.apiUrl}/api/posts/${t}/repost`,{comment:e})}toggleBookmark(t){return this.http.post(`${this.apiUrl}/api/posts/${t}/bookmark`,{})}getUserProfile(t){return this.http.get(`${this.apiUrl}/api/users/${t}/profile`)}static \u0275fac=function(e){return new(e||o)(w(E))};static \u0275prov=y({token:o,factory:o.\u0275fac,providedIn:"root"})};function q(o,t){o&1&&(i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),l(7,"span",8),n(),i(8,"div",9)(9,"div",7),l(10,"span",10)(11,"span",11),n()()(),i(12,"div",7),l(13,"span",12)(14,"span",13)(15,"span",14),n()()()()()())}function A(o,t){if(o&1){let e=x();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",15)(4,"h4"),c(5,"Oops! Something went wrong"),n(),i(6,"p"),c(7),n(),i(8,"button",16),_("click",function(){p(e);let s=m();return g(s.loadPost())}),c(9," Try Again "),n()()()()()}if(o&2){let e=m();r(7),P(e.error)}}function L(o,t){o&1&&l(0,"i",51)}function Q(o,t){if(o&1&&(i(0,"div",57),l(1,"img",58),n()),o&2){let e=m(),a=e.$implicit,s=e.index;r(),d("src",a.thumbnail_url||a.url,h)("alt","Image "+(s+1))}}function H(o,t){if(o&1&&(i(0,"div",59)(1,"video",60),c(2," Your browser does not support the video tag. "),n()()),o&2){let e=m().$implicit;r(),d("src",e.url,h)}}function N(o,t){if(o&1){let e=x();i(0,"div",54),_("click",function(){let s=p(e).$implicit,b=m(3);return g(b.onMediaClick(s))}),f(1,Q,2,2,"div",55)(2,H,3,1,"div",56),n()}if(o&2){let e=t.$implicit;r(),d("ngIf",e.file_type==="image"),r(),d("ngIf",e.file_type==="video")}}function Y(o,t){if(o&1&&(i(0,"div",52),f(1,N,3,2,"div",53),n()),o&2){let e=m(2);d("ngClass",e.getMediaClass(e.post.media.length)),r(),d("ngForOf",e.post.media)}}function B(o,t){if(o&1){let e=x();i(0,"div",61)(1,"div",62)(2,"div",63)(3,"div",64)(4,"div",65),l(5,"img",66),n(),i(6,"div",67)(7,"h6",68),c(8,"Share this post"),n(),i(9,"small",69),c(10,"Scan to view this post or share with others"),n()(),i(11,"div",65)(12,"button",70),_("click",function(){p(e);let s=m(2);return g(s.downloadQrCode())}),l(13,"i",71),n()()()()()()}if(o&2){let e=m(2);r(5),d("src",e.post.qr_code_url,h)}}function G(o,t){if(o&1&&(i(0,"div",72)(1,"div",5)(2,"div",73),l(3,"img",74),i(4,"div")(5,"h6",75),c(6),n(),i(7,"small",69),c(8),n()()(),i(9,"p",76),c(10),n()()()),o&2){let e=m(2);r(3),d("src",e.user.avatar||"./images/user.svg",h)("alt",e.user.name),r(3),u("About ",e.user.name,""),r(2),u("@",e.user.username,""),r(2),P(e.user.bio)}}function J(o,t){if(o&1){let e=x();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",17)(4,"button",18),_("click",function(){p(e);let s=m();return g(s.goToUserProfile())}),l(5,"i",19),c(6),n()(),i(7,"div",20)(8,"div",5)(9,"div",6)(10,"div",21),_("click",function(){p(e);let s=m();return g(s.goToUserProfile())}),l(11,"img",22),n(),i(12,"div",9)(13,"div",23)(14,"h6",24),_("click",function(){p(e);let s=m();return g(s.goToUserProfile())}),c(15),f(16,L,1,0,"i",25),n()(),i(17,"small",26),_("click",function(){p(e);let s=m();return g(s.goToUserProfile())}),c(18),n()(),i(19,"div",27)(20,"button",28),l(21,"i",29),n(),i(22,"ul",30)(23,"li")(24,"button",31),_("click",function(){p(e);let s=m();return g(s.sharePost())}),l(25,"i",32),c(26," Share Post "),n()(),i(27,"li")(28,"button",31),_("click",function(){p(e);let s=m();return g(s.copyToClipboard())}),l(29,"i",33),c(30," Copy Link "),n()()()()(),i(31,"div",34),l(32,"p",35),n(),f(33,Y,2,2,"div",36)(34,B,14,1,"div",37),i(35,"div",38)(36,"div",39)(37,"small"),l(38,"i",40),c(39),n(),i(40,"div",41)(41,"span",23),l(42,"i",42),c(43),n(),i(44,"span",23),l(45,"i",43),c(46),n(),i(47,"span",23),l(48,"i",44),c(49),n()()()(),i(50,"div",45)(51,"div",46)(52,"button",47),l(53,"i",42),c(54," Like "),n(),i(55,"button",47),l(56,"i",43),c(57," Repost "),n(),i(58,"button",47),l(59,"i",44),c(60," Reply "),n(),i(61,"button",48),_("click",function(){p(e);let s=m();return g(s.sharePost())}),l(62,"i",49),c(63," Share "),n()()()()(),f(64,G,11,5,"div",50),n()()()}if(o&2){let e=m();r(6),u(" Back to ",e.user.name,"'s profile "),r(5),d("src",e.user.avatar||"./images/user.svg",h)("alt",e.user.name),r(4),u(" ",e.user.name," "),r(),d("ngIf",e.user.is_verified),r(2),u(" @",e.user.username," "),r(14),d("innerHTML",e.post.content,M),r(),d("ngIf",e.post.media&&e.post.media.length>0),r(),d("ngIf",e.post.qr_code_url),r(5),u(" ",e.formatDate(e.post.created_at)," "),r(4),u(" ",e.post.likes_count," "),r(3),u(" ",e.post.reposts_count," "),r(3),u(" ",e.post.replies_count," "),r(15),d("ngIf",e.user.bio)}}var j=class o{route=v(U);router=v(V);postService=v(C);titleService=v($);metaService=v(D);toastService=v(z);post=null;user=null;loading=!0;error=null;userId="";postId="";ngOnInit(){this.route.params.subscribe(t=>{this.userId=t.userId,this.postId=t.postId,this.loadPost()})}loadPost(){this.loading=!0,this.error=null,this.postService.getPost(this.userId,this.postId).subscribe({next:t=>{t.success&&t.data?(this.post=t.data,this.user=t.data.user,this.setPageMeta()):(this.error="Post not found",this.router.navigate(["/404"])),this.loading=!1},error:t=>{console.error("Error loading post:",t),this.error="Failed to load post",this.loading=!1,t.status===404&&this.router.navigate(["/404"])}})}setPageMeta(){if(!this.post||!this.user)return;let t=`${this.user.name} (@${this.user.username}) on ShareAScan`;if(this.titleService.setTitle(t),this.metaService.updateTag({name:"description",content:this.post.content||"View this post on ShareAScan"}),this.metaService.updateTag({property:"og:title",content:t}),this.metaService.updateTag({property:"og:description",content:this.post.content||"View this post on ShareAScan"}),this.metaService.updateTag({property:"og:type",content:"article"}),this.metaService.updateTag({property:"og:url",content:window.location.href}),this.post.media&&this.post.media.length>0){let e=this.post.media.find(a=>a.file_type==="image");e&&this.metaService.updateTag({property:"og:image",content:e.url})}this.metaService.updateTag({name:"twitter:card",content:"summary_large_image"}),this.metaService.updateTag({name:"twitter:title",content:t}),this.metaService.updateTag({name:"twitter:description",content:this.post.content||"View this post on ShareAScan"})}formatDate(t){let e=new Date(t),s=Math.abs(new Date().getTime()-e.getTime()),b=Math.ceil(s/(1e3*60*60*24));return b===1?"Yesterday":b<7?`${b} days ago`:e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}onMediaClick(t){t.file_type==="video"||window.open(t.url,"_blank")}goToUserProfile(){this.user&&this.router.navigate(["/users",this.user.username])}sharePost(){navigator.share?navigator.share({title:`Post by ${this.user?.name}`,text:this.post?.content,url:window.location.href}).catch(t=>{console.log("Error sharing:",t),this.copyToClipboard()}):this.copyToClipboard()}copyToClipboard(){navigator.clipboard.writeText(window.location.href).then(()=>{this.toastService.showToast("Link copied to clipboard!","success")}).catch(t=>{console.error("Failed to copy: ",t),this.toastService.showToast("Failed to copy link","error")})}getMediaClass(t){return t===1?"single-media":t===2?"two-media":t===3?"three-media":"multiple-media"}downloadQrCode(){if(!this.post?.qr_code_url){this.toastService.showToast("QR code not available","error");return}try{let t=document.createElement("a");t.href=this.post.qr_code_url,t.download=`post-${this.post.id}-qr-code.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.toastService.showToast("QR code downloaded successfully!","success")}catch(t){console.error("Error downloading QR code:",t),this.toastService.showToast("Failed to download QR code","error")}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=O({type:o,selectors:[["app-post-display"]],decls:3,vars:3,consts:[["class","container-fluid mt-4",4,"ngIf"],[1,"container-fluid","mt-4"],[1,"row","justify-content-center"],[1,"col-12","col-md-8","col-lg-6"],[1,"card"],[1,"card-body"],[1,"d-flex","align-items-center","mb-3"],[1,"placeholder-glow"],[1,"placeholder","rounded-circle",2,"width","50px","height","50px"],[1,"ms-3","flex-grow-1"],[1,"placeholder","col-4"],[1,"placeholder","col-3"],[1,"placeholder","col-12"],[1,"placeholder","col-8"],[1,"placeholder","col-10"],[1,"alert","alert-danger","text-center"],[1,"btn","btn-outline-danger",3,"click"],[1,"mb-3"],[1,"btn","btn-link","p-0","text-decoration-none",3,"click"],[1,"fas","fa-arrow-left","me-2"],[1,"card","shadow-sm","border-0","post-card"],[1,"user-avatar",3,"click"],["onerror","this.src='./images/user.svg'",1,"rounded-circle","cursor-pointer",2,"width","50px","height","50px","object-fit","cover",3,"src","alt"],[1,"d-flex","align-items-center"],[1,"mb-0","fw-bold","cursor-pointer",3,"click"],["class","fas fa-check-circle text-primary ms-1",4,"ngIf"],[1,"text-muted","cursor-pointer",3,"click"],[1,"dropdown"],["data-bs-toggle","dropdown",1,"btn","btn-link","text-muted","p-0"],[1,"fas","fa-ellipsis-h"],[1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],[1,"fas","fa-share","me-2"],[1,"fas","fa-link","me-2"],[1,"post-content","mb-3"],[1,"mb-0",3,"innerHTML"],["class","media-gallery mb-3",3,"ngClass",4,"ngIf"],["class","qr-code-section mb-3",4,"ngIf"],[1,"post-meta"],[1,"d-flex","justify-content-between","align-items-center","text-muted"],[1,"far","fa-clock","me-1"],[1,"d-flex","gap-3"],[1,"far","fa-heart","me-1"],[1,"fas","fa-retweet","me-1"],[1,"far","fa-comment","me-1"],[1,"post-actions","mt-3","pt-3","border-top"],[1,"d-flex","justify-content-around"],[1,"btn","btn-link","text-muted","p-2"],[1,"btn","btn-link","text-muted","p-2",3,"click"],[1,"fas","fa-share","me-1"],["class","card shadow-sm border-0 mt-3",4,"ngIf"],[1,"fas","fa-check-circle","text-primary","ms-1"],[1,"media-gallery","mb-3",3,"ngClass"],["class","media-item",3,"click",4,"ngFor","ngForOf"],[1,"media-item",3,"click"],["class","image-container",4,"ngIf"],["class","video-container",4,"ngIf"],[1,"image-container"],["loading","lazy",1,"img-fluid","rounded","cursor-pointer",3,"src","alt"],[1,"video-container"],["controls","","preload","metadata",1,"img-fluid","rounded","cursor-pointer",3,"src"],[1,"qr-code-section","mb-3"],[1,"card","bg-light","border-0"],[1,"card-body","p-3"],[1,"row","align-items-center"],[1,"col-auto"],["alt","QR Code for this post",1,"img-fluid","rounded",2,"width","80px","height","80px",3,"src"],[1,"col"],[1,"mb-1"],[1,"text-muted"],["title","Download QR Code",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"fas","fa-download"],[1,"card","shadow-sm","border-0","mt-3"],[1,"d-flex","align-items-center","mb-2"],[1,"rounded-circle","me-3",2,"width","40px","height","40px","object-fit","cover",3,"src","alt"],[1,"mb-0"],[1,"mb-0","text-muted"]],template:function(e,a){e&1&&f(0,q,16,0,"div",0)(1,A,10,1,"div",0)(2,J,65,14,"div",0),e&2&&(d("ngIf",a.loading),r(),d("ngIf",a.error&&!a.loading),r(),d("ngIf",a.post&&a.user&&!a.loading))},dependencies:[I,k,S,T],styles:['.post-card[_ngcontent-%COMP%]{border-radius:15px;transition:all .3s ease}.post-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a!important}.user-avatar[_ngcontent-%COMP%]{position:relative}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer;transition:opacity .2s ease}.cursor-pointer[_ngcontent-%COMP%]:hover{opacity:.8}.post-content[_ngcontent-%COMP%]{font-size:1.1rem;line-height:1.6;color:#333}.post-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:.5rem}.media-gallery[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}.media-item[_ngcontent-%COMP%]{position:relative;overflow:hidden}.media-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .media-item[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{transition:transform .3s ease}.media-item[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%], .media-item[_ngcontent-%COMP%]:hover   video[_ngcontent-%COMP%]{transform:scale(1.02)}.single-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]{max-height:500px}.single-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .single-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:auto;max-height:500px;object-fit:cover}.two-media[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2px}.two-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .two-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:250px;object-fit:cover}.three-media[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr;grid-template-rows:1fr 1fr;gap:2px;height:300px}.three-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]:first-child{grid-row:1 / 3}.three-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .three-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.multiple-media[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;gap:2px;height:300px}.multiple-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .multiple-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.post-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border:none;font-size:.9rem;transition:all .2s ease;border-radius:20px}.post-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background-color:rgba(var(--bs-primary-rgb),.1);color:var(--bs-primary);transform:translateY(-1px)}.post-meta[_ngcontent-%COMP%]{font-size:.9rem}.post-meta[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:.7}.placeholder[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}@media (max-width: 576px){.post-content[_ngcontent-%COMP%]{font-size:1rem}.two-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .two-media[_ngcontent-%COMP%]   .media-item[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{height:200px}.three-media[_ngcontent-%COMP%], .multiple-media[_ngcontent-%COMP%]{height:250px}.post-actions[_ngcontent-%COMP%]{font-size:.8rem}.post-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.5rem .75rem}}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border:none}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#5a67d8,#6b46c1);transform:translateY(-1px)}.text-primary[_ngcontent-%COMP%]{color:#667eea!important}.fa-check-circle[_ngcontent-%COMP%]{font-size:.9rem}.dropdown-menu[_ngcontent-%COMP%]{border:none;box-shadow:0 4px 20px #0000001a;border-radius:10px}.dropdown-item[_ngcontent-%COMP%]{padding:.75rem 1rem;transition:background-color .2s ease}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:rgba(var(--bs-primary-rgb),.1);color:var(--bs-primary)}.btn-link[_ngcontent-%COMP%]{text-decoration:none!important;color:#6c757d;font-weight:500}.btn-link[_ngcontent-%COMP%]:hover{color:var(--bs-primary)}img[src="./images/user.svg"][_ngcontent-%COMP%]{background-color:#f8f9fa;padding:8px}']})};export{j as PostDisplayComponent};
